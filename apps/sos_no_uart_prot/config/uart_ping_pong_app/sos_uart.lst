   1               		.file	"sos_uart.c"
   2               		.arch atmega103
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  17               	.Ltext0:
  18               		.section	.progmem.data,"a",@progbits
  21               	uart_mod_header:
  22 0000 48        		.byte	72
  23 0001 00        		.byte	0
  24 0002 01        		.byte	1
  25 0003 00        		.byte	0
  26 0004 00        		.byte	0
  27 0005 0000 0000 		.skip 7,0
  27      0000 00
  28 000c 0000      		.word	pm(sos_uart_msg_handler)
  29               		.text
  30               	.global	sos_uart_init
  32               	sos_uart_init:
  33               	.LFB18:
  34               	.LM1:
  35               	/* prologue: frame size=0 */
  36               	/* prologue end (size=0) */
  37               	.LM2:
  38 0000 1092 0000 		sts s,__zero_reg__
  39               	.LM3:
  40 0004 1092 0000 		sts (s+1)+1,__zero_reg__
  41 0008 1092 0000 		sts s+1,__zero_reg__
  42               	.LM4:
  43 000c 0E94 0000 		call ker_id
  44 0010 0E94 0000 		call set_uart_address
  45               	.LM5:
  46 0014 80E0      		ldi r24,lo8(uart_mod_header)
  47 0016 90E0      		ldi r25,hi8(uart_mod_header)
  48 0018 AA27      		clr r26
  49 001a 97FD      		sbrc r25,7
  50 001c A095      		com r26
  51 001e BA2F      		mov r27,r26
  52 0020 B695      		lsr r27
  53 0022 A795      		ror r26
  54 0024 9795      		ror r25
  55 0026 8795      		ror r24
  56 0028 0E94 0000 		call ker_register_module
  57               	.LM6:
  58 002c 80E0      		ldi r24,lo8(uartpq)
  59 002e 90E0      		ldi r25,hi8(uartpq)
  60 0030 0E94 0000 		call mq_init
  61               	/* epilogue: frame size=0 */
  62 0034 0895      		ret
  63               	/* epilogue end (size=1) */
  64               	/* function sos_uart_init size 27 (26) */
  65               	.LFE18:
  68               	uart_try_reserve_and_send:
  69               	.LFB19:
  70               	.LM7:
  71               	/* prologue: frame size=0 */
  72 0036 CF93      		push r28
  73 0038 DF93      		push r29
  74               	/* prologue end (size=2) */
  75 003a D92F      		mov r29,r25
  76 003c C82F      		mov r28,r24
  77               	.LM8:
  78 003e 60EC      		ldi r22,lo8(-64)
  79 0040 88E4      		ldi r24,lo8(72)
  80 0042 0E94 0000 		call ker_uart_reserve_bus
  81 0046 8823      		tst r24
  82 0048 21F0      		breq .L3
  83               	.LM9:
  84 004a 88E4      		ldi r24,lo8(72)
  85 004c 0E94 0000 		call ker_uart_release_bus
  86               	.LM10:
  87 0050 0CC0      		rjmp .L4
  88               	.L3:
  89               	.LM11:
  90 0052 48E4      		ldi r20,lo8(72)
  91 0054 6F81      		ldd r22,Y+7
  92 0056 8C2F      		mov r24,r28
  93 0058 9D2F      		mov r25,r29
  94 005a 0E94 0000 		call ker_uart_send_data
  95 005e 8823      		tst r24
  96 0060 21F4      		brne .L4
  97               	.LM12:
  98 0062 82E0      		ldi r24,lo8(2)
  99 0064 8093 0000 		sts s,r24
 100               	.LM13:
 101 0068 11C0      		rjmp .L2
 102               	.L4:
 103               	.LM14:
 104 006a 81E0      		ldi r24,lo8(1)
 105 006c 8093 0000 		sts s,r24
 106               	.LM15:
 107 0070 6C2F      		mov r22,r28
 108 0072 7D2F      		mov r23,r29
 109 0074 80E0      		ldi r24,lo8(uartpq)
 110 0076 90E0      		ldi r25,hi8(uartpq)
 111 0078 0E94 0000 		call mq_enqueue
 112               	.LM16:
 113 007c 20E0      		ldi r18,lo8(256)
 114 007e 31E0      		ldi r19,hi8(256)
 115 0080 40E0      		ldi r20,hlo8(256)
 116 0082 50E0      		ldi r21,hhi8(256)
 117 0084 60E0      		ldi r22,lo8(0)
 118 0086 88E4      		ldi r24,lo8(72)
 119 0088 0E94 0000 		call ker_timer_restart
 120               	.L2:
 121               	/* epilogue: frame size=0 */
 122 008c DF91      		pop r29
 123 008e CF91      		pop r28
 124 0090 0895      		ret
 125               	/* epilogue end (size=3) */
 126               	/* function uart_try_reserve_and_send size 46 (41) */
 127               	.LFE19:
 129               	.global	uart_msg_alloc
 131               	uart_msg_alloc:
 132               	.LFB21:
 133               	.LM17:
 134               	/* prologue: frame size=0 */
 135 0092 1F93      		push r17
 136 0094 CF93      		push r28
 137 0096 DF93      		push r29
 138               	/* prologue end (size=3) */
 139 0098 D92F      		mov r29,r25
 140 009a C82F      		mov r28,r24
 141               	.LM18:
 142 009c 8A85      		ldd r24,Y+10
 143 009e 9B85      		ldd r25,Y+11
 144 00a0 82FF      		sbrs r24,2
 145 00a2 05C0      		rjmp .L7
 146               	.LBB2:
 147               	.LBB3:
 148               	.LM19:
 149 00a4 68E4      		ldi r22,lo8(72)
 150 00a6 8885      		ldd r24,Y+8
 151 00a8 9985      		ldd r25,Y+9
 152 00aa 0E94 0000 		call sos_blk_mem_change_own
 153               	.L7:
 154               	.LBE3:
 155               	.LBE2:
 156               	.LM20:
 157               	/* #APP */
 158 00ae 1FB7      		in r17, __SREG__
 159 00b0 F894      		cli
 160               		
 161               	.LM21:
 162               	/* #NOAPP */
 163 00b2 8091 0000 		lds r24,s
 164 00b6 8823      		tst r24
 165 00b8 49F4      		brne .L9
 166               	.LM22:
 167 00ba D093 0000 		sts (s+1)+1,r29
 168 00be C093 0000 		sts s+1,r28
 169               	.LM23:
 170 00c2 8C2F      		mov r24,r28
 171 00c4 9D2F      		mov r25,r29
 172 00c6 0E94 0000 		call uart_try_reserve_and_send
 173 00ca 06C0      		rjmp .L10
 174               	.L9:
 175               	.LM24:
 176 00cc 6C2F      		mov r22,r28
 177 00ce 7D2F      		mov r23,r29
 178 00d0 80E0      		ldi r24,lo8(uartpq)
 179 00d2 90E0      		ldi r25,hi8(uartpq)
 180 00d4 0E94 0000 		call mq_enqueue
 181               	.L10:
 182               	.LM25:
 183               	/* #APP */
 184 00d8 1FBF      		out __SREG__, r17
 185               		
 186               	/* #NOAPP */
 187               	/* epilogue: frame size=0 */
 188 00da DF91      		pop r29
 189 00dc CF91      		pop r28
 190 00de 1F91      		pop r17
 191 00e0 0895      		ret
 192               	/* epilogue end (size=4) */
 193               	/* function uart_msg_alloc size 47 (40) */
 194               	.LFE21:
 197               	sos_uart_msg_handler:
 198               	.LFB22:
 199               	.LM26:
 200               	/* prologue: frame size=0 */
 201 00e2 1F93      		push r17
 202 00e4 CF93      		push r28
 203 00e6 DF93      		push r29
 204               	/* prologue end (size=3) */
 205 00e8 F72F      		mov r31,r23
 206 00ea E62F      		mov r30,r22
 207               	.LM27:
 208               	/* #APP */
 209 00ec 1FB7      		in r17, __SREG__
 210 00ee F894      		cli
 211               		
 212               	.LM28:
 213               	/* #NOAPP */
 214 00f0 8681      		ldd r24,Z+6
 215 00f2 9927      		clr r25
 216 00f4 8630      		cpi r24,6
 217 00f6 9105      		cpc r25,__zero_reg__
 218 00f8 C9F0      		breq .L14
 219               	.LM29:
 220 00fa 8730      		cpi r24,7
 221 00fc 9105      		cpc r25,__zero_reg__
 222 00fe 34F4      		brge .L27
 223 0100 0097      		sbiw r24,0
 224 0102 61F0      		breq .L13
 225 0104 0297      		sbiw r24,2
 226 0106 09F4      		brne .+2
 227 0108 47C0      		rjmp .L22
 228 010a 74C0      		rjmp .L26
 229               	.L27:
 230 010c 8F30      		cpi r24,15
 231 010e 9105      		cpc r25,__zero_reg__
 232 0110 09F4      		brne .+2
 233 0112 55C0      		rjmp .L25
 234 0114 8234      		cpi r24,66
 235 0116 9105      		cpc r25,__zero_reg__
 236 0118 71F0      		breq .L15
 237 011a 6CC0      		rjmp .L26
 238               	.L13:
 239               	.LM30:
 240 011c 1092 0000 		sts s,__zero_reg__
 241               	.LM31:
 242 0120 41E0      		ldi r20,lo8(1)
 243 0122 60E0      		ldi r22,lo8(0)
 244 0124 88E4      		ldi r24,lo8(72)
 245 0126 0E94 0000 		call ker_timer_init
 246               	.LM32:
 247 012a 68C0      		rjmp .L12
 248               	.L14:
 249               	.LM33:
 250 012c 60E0      		ldi r22,lo8(0)
 251 012e 88E4      		ldi r24,lo8(72)
 252 0130 0E94 0000 		call ker_timer_stop
 253               	.LM34:
 254 0134 63C0      		rjmp .L12
 255               	.L15:
 256               	.LBB4:
 257               	.LM35:
 258 0136 8285      		ldd r24,Z+10
 259               	.LBB5:
 260               	.LM36:
 261 0138 2091 0000 		lds r18,s+1
 262 013c 3091 0000 		lds r19,(s+1)+1
 263               	.LM37:
 264 0140 1092 0000 		sts (s+1)+1,__zero_reg__
 265 0144 1092 0000 		sts s+1,__zero_reg__
 266               	.LM38:
 267 0148 60E0      		ldi r22,lo8(0)
 268 014a 81FF      		sbrs r24,1
 269 014c 61E0      		ldi r22,lo8(1)
 270               	.L16:
 271 014e 48E4      		ldi r20,lo8(72)
 272 0150 932F      		mov r25,r19
 273 0152 822F      		mov r24,r18
 274 0154 0E94 0000 		call msg_send_senddone
 275               	.LM39:
 276 0158 80E0      		ldi r24,lo8(uartpq)
 277 015a 90E0      		ldi r25,hi8(uartpq)
 278 015c 0E94 0000 		call mq_dequeue
 279 0160 D92F      		mov r29,r25
 280 0162 C82F      		mov r28,r24
 281 0164 9093 0000 		sts (s+1)+1,r25
 282 0168 8093 0000 		sts s+1,r24
 283               	.LM40:
 284 016c 0097      		sbiw r24,0
 285 016e 09F1      		breq .L23
 286               	.LBB6:
 287               	.LBB7:
 288               	.LM41:
 289 0170 48E4      		ldi r20,lo8(72)
 290 0172 6F81      		ldd r22,Y+7
 291 0174 0E94 0000 		call ker_uart_send_data
 292 0178 8823      		tst r24
 293 017a 51F0      		breq .L18
 294               	.LM42:
 295 017c 81E0      		ldi r24,lo8(1)
 296 017e 8093 0000 		sts s,r24
 297               	.LM43:
 298 0182 6C2F      		mov r22,r28
 299 0184 7D2F      		mov r23,r29
 300 0186 80E0      		ldi r24,lo8(uartpq)
 301 0188 90E0      		ldi r25,hi8(uartpq)
 302 018a 0E94 0000 		call mq_enqueue
 303 018e 29C0      		rjmp .L28
 304               	.L18:
 305               	.LM44:
 306 0190 82E0      		ldi r24,lo8(2)
 307 0192 8093 0000 		sts s,r24
 308               	.LBE7:
 309               	.LBE6:
 310 0196 32C0      		rjmp .L12
 311               	.L22:
 312               	.LBE5:
 313               	.LBE4:
 314               	.LM45:
 315 0198 80E0      		ldi r24,lo8(uartpq)
 316 019a 90E0      		ldi r25,hi8(uartpq)
 317 019c 0E94 0000 		call mq_dequeue
 318 01a0 9093 0000 		sts (s+1)+1,r25
 319 01a4 8093 0000 		sts s+1,r24
 320               	.LM46:
 321 01a8 0097      		sbiw r24,0
 322 01aa 19F0      		breq .L23
 323               	.LM47:
 324 01ac 0E94 0000 		call uart_try_reserve_and_send
 325 01b0 25C0      		rjmp .L12
 326               	.L23:
 327               	.LM48:
 328 01b2 88E4      		ldi r24,lo8(72)
 329 01b4 0E94 0000 		call ker_uart_release_bus
 330               	.LM49:
 331 01b8 1092 0000 		sts s,__zero_reg__
 332               	.LM50:
 333 01bc 1FC0      		rjmp .L12
 334               	.L25:
 335               	.LBB8:
 336               	.LM51:
 337 01be 88E4      		ldi r24,lo8(72)
 338 01c0 0E94 0000 		call ker_uart_release_bus
 339               	.LM52:
 340 01c4 8091 0000 		lds r24,s+1
 341 01c8 9091 0000 		lds r25,(s+1)+1
 342               	.LM53:
 343 01cc 1092 0000 		sts (s+1)+1,__zero_reg__
 344 01d0 1092 0000 		sts s+1,__zero_reg__
 345               	.LM54:
 346 01d4 48E4      		ldi r20,lo8(72)
 347 01d6 60E0      		ldi r22,lo8(0)
 348 01d8 0E94 0000 		call msg_send_senddone
 349               	.LM55:
 350 01dc 81E0      		ldi r24,lo8(1)
 351 01de 8093 0000 		sts s,r24
 352               	.L28:
 353               	.LM56:
 354 01e2 20E0      		ldi r18,lo8(256)
 355 01e4 31E0      		ldi r19,hi8(256)
 356 01e6 40E0      		ldi r20,hlo8(256)
 357 01e8 50E0      		ldi r21,hhi8(256)
 358 01ea 60E0      		ldi r22,lo8(0)
 359 01ec 88E4      		ldi r24,lo8(72)
 360 01ee 0E94 0000 		call ker_timer_restart
 361               	.LM57:
 362 01f2 04C0      		rjmp .L12
 363               	.L26:
 364               	.LBE8:
 365               	.LM58:
 366               	/* #APP */
 367 01f4 1FBF      		out __SREG__, r17
 368               		
 369               	.LM59:
 370               	/* #NOAPP */
 371 01f6 8AEE      		ldi r24,lo8(-22)
 372 01f8 9FEF      		ldi r25,hi8(-22)
 373 01fa 03C0      		rjmp .L11
 374               	.L12:
 375               	.LM60:
 376               	/* #APP */
 377 01fc 1FBF      		out __SREG__, r17
 378               		
 379               	.LM61:
 380               	/* #NOAPP */
 381 01fe 80E0      		ldi r24,lo8(0)
 382 0200 90E0      		ldi r25,hi8(0)
 383               	.L11:
 384               	/* epilogue: frame size=0 */
 385 0202 DF91      		pop r29
 386 0204 CF91      		pop r28
 387 0206 1F91      		pop r17
 388 0208 0895      		ret
 389               	/* epilogue end (size=4) */
 390               	/* function sos_uart_msg_handler size 160 (153) */
 391               	.LFE22:
 393               		.lcomm uartpq,16
 394               		.lcomm s,3
 395               	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 sos_uart.c
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:3      *ABS*:0000003f __SREG__
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:4      *ABS*:0000003e __SP_H__
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:5      *ABS*:0000003d __SP_L__
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:6      *ABS*:00000000 __tmp_reg__
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:7      *ABS*:00000001 __zero_reg__
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:21     .progmem.data:00000000 uart_mod_header
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:197    .text:000000e2 sos_uart_msg_handler
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:32     .text:00000000 sos_uart_init
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:393    .bss:00000010 s
                             .bss:00000000 uartpq
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:68     .text:00000036 uart_try_reserve_and_send
c:\DOCUME~1\jlhsu\LOCALS~1\Temp/ccUTdaaa.s:131    .text:00000092 uart_msg_alloc

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
ker_id
set_uart_address
ker_register_module
mq_init
ker_uart_reserve_bus
ker_uart_release_bus
ker_uart_send_data
mq_enqueue
ker_timer_restart
sos_blk_mem_change_own
ker_timer_init
ker_timer_stop
msg_send_senddone
mq_dequeue
